'use client'

import { Button } from '@/components/0_Bruddle'

// inline peanut icon svg to ensure it works offline without needing to fetch external assets
const PeanutIcon = ({ className }: { className?: string }) => (
    <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 291 389"
        fill="none"
        aria-label="Peanut Logo"
        className={className}
    >
        {/* <!-- Peanut shape --> */}
        <path
            d="M60.3258 45.632C64.7897 43.0841 70.8696 42.4485 77.6753 42.1648L77.6751 42.1639C86.6738 41.7919 95.9563 42.9122 105.073 44.8494C131.211 50.4032 159.276 64.4612 173.241 88.947L173.241 88.948C182.385 105.004 187.299 122.974 187.679 140.59L187.68 140.615L187.681 140.639C188.214 158.799 197.656 175.377 213.007 185.103L213.027 185.115L213.048 185.129C227.987 194.435 240.944 207.825 250.088 223.88L250.089 223.881C264.205 248.652 262.114 279.714 253.648 304.817C253.251 305.963 252.866 307.057 252.469 308.126L252.46 308.151L252.45 308.178C252.436 308.216 252.422 308.255 252.408 308.294C252.395 308.33 252.381 308.367 252.367 308.403C246.631 323.792 238.741 335.81 232.382 341.201C232.326 341.246 232.276 341.285 232.239 341.315C232.158 341.378 232.121 341.409 232.087 341.434L232.052 341.462L232.017 341.489C231.506 341.893 231.256 342.093 231.002 342.275C230.703 342.487 230.41 342.68 230.129 342.856L229.759 343.068C226.058 345.176 218.929 346.766 209.112 346.794C199.522 346.822 188.125 345.356 176.457 342.08C153.35 335.592 130.193 322.32 117.448 300.794L116.849 299.762C107.705 283.706 102.79 265.736 102.41 248.12L102.409 248.096L102.409 248.072C101.876 229.912 92.433 213.335 77.0818 203.609L77.0617 203.595L77.0418 203.583L75.6472 202.699C61.7596 193.736 49.6638 181.222 40.8698 166.328L40.0013 164.831L39.4191 163.79C27.402 141.848 27.7929 115.163 33.9934 91.9808C37.1244 80.275 41.6741 69.7248 46.5873 61.491C51.6171 53.0618 56.6207 47.7423 60.3214 45.6342L60.3258 45.632Z"
            fill="#FFC900"
            stroke="black"
            stroke-width="12.6195"
        />

        {/* <!-- Eye lines --> */}
        <path d="M106.78 163.414L112.666 153.471" stroke="black" stroke-width="8.41298" stroke-linecap="round" />

        {/* <!-- Left eye --> */}
        <path
            d="M85.1709 145.907C98.5727 145.757 109.316 134.772 109.167 121.37C109.017 107.968 98.0318 97.2252 84.63 97.3746C71.2282 97.524 60.485 108.509 60.6344 121.911C60.7838 135.313 71.7691 146.056 85.1709 145.907Z"
            fill="white"
            stroke="black"
            stroke-width="8.41298"
        />

        {/* <!-- Right eye --> */}
        <path
            d="M127.511 122.531C140.913 122.382 151.656 111.396 151.507 97.9945C151.357 84.5927 140.372 73.8495 126.97 73.9989C113.569 74.1482 102.825 85.1336 102.975 98.5354C103.124 111.937 114.109 122.68 127.511 122.531Z"
            fill="white"
            stroke="black"
            stroke-width="8.41298"
        />

        {/* <!-- Right pupil --> */}
        <path
            d="M124.817 75.0371C119.025 82.8635 118.786 93.8654 124.943 102.046C130.198 109.028 138.726 112.102 146.794 110.725C152.587 102.898 152.825 91.8966 146.669 83.7158C141.413 76.7341 132.886 73.66 124.817 75.0371Z"
            fill="black"
        />

        {/* <!-- Left pupil --> */}
        <path
            d="M83.7629 98.3403C78.1936 106.086 78.0308 116.853 84.0684 124.879C89.0469 131.494 96.9795 134.564 104.643 133.65C110.213 125.904 110.376 115.137 104.338 107.111C99.3594 100.497 91.4268 97.426 83.7629 98.3403Z"
            fill="black"
        />

        {/* <!-- Smile --> */}
        <path
            d="M114.128 159.598C119.673 161.038 126.095 160.674 131.417 158.723C136.777 156.752 143.396 151.325 146.285 146.32"
            stroke="black"
            stroke-width="8.41298"
            stroke-linecap="round"
        />

        {/* <!-- Decorative marks --> */}
        <path
            d="M167.532 301.188C165.712 303.217 165.711 306.678 167.731 308.499C175.837 315.761 184.838 322.018 193.382 326.574C194.974 327.639 196.695 327.161 198.187 326.316C198.933 325.888 199.46 325.083 200.007 324.287C201.41 321.512 200.276 318.677 198.088 317.453C190.131 313.066 181.925 307.356 174.625 300.611C172.596 298.81 169.333 299.178 167.532 301.188Z"
            fill="black"
        />
        <path
            d="M153.183 290.974L153.56 290.755C155.958 288.886 156.395 286.16 154.904 283.544C152.815 280.769 151.114 277.775 149.414 274.79C146.221 269.18 143.406 263.361 140.791 257.919C139.677 255.085 136.743 254.288 133.898 255.402C131.063 256.516 130.267 259.451 131.381 262.295C133.828 268.323 137.239 274.312 140.641 280.29C142.55 283.652 144.261 286.646 146.558 289.8C148.19 291.81 150.915 292.247 153.163 290.974L153.183 290.974Z"
            fill="black"
        />
        <path
            d="M127.138 237.548L128.262 236.911C130.132 235.847 131.147 233.29 130.829 231.002C128.91 224.169 126.046 217.385 122.425 211.028C120.724 208.034 119.014 205.04 116.935 202.275C115.066 199.877 111.972 199.648 109.943 201.309C107.545 203.179 107.317 206.272 108.977 208.302C110.847 210.699 112.339 213.315 113.831 215.941C117.023 221.551 119.48 227.58 121.33 233.449C121.697 236.701 124.691 238.462 127.128 237.548L127.138 237.548Z"
            fill="black"
        />
        <path
            d="M227.981 310.352C229.155 310.67 229.891 310.252 230.637 309.825C232.129 308.979 233.204 307.378 233.313 305.826C233.752 296.178 232.967 285.227 230.849 274.545C230.312 271.869 227.696 269.9 224.662 270.645C221.987 271.182 220.017 273.798 220.763 276.832C222.831 286.54 223.566 296.526 223.287 305.607C223.227 308.113 225.097 310.51 227.981 310.361L227.981 310.352Z"
            fill="black"
        />
        <path
            d="M168.556 168.157C165.721 169.271 164.924 172.205 165.82 174.662C167.143 177.875 168.853 180.869 170.544 183.843C174.164 190.2 178.53 196.119 183.444 201.252C184.886 202.903 187.601 203.331 189.84 202.058L190.964 201.421C192.784 199.392 192.993 196.299 191.342 194.279C186.876 189.902 183.296 184.511 180.103 178.9C178.612 176.284 177.13 173.668 176.006 170.823C174.136 168.426 171.371 167.023 168.546 168.147L168.556 168.157Z"
            fill="black"
        />
        <path
            d="M204.901 216.7C202.504 218.57 202.275 221.664 203.558 223.912C207.278 228.716 210.47 234.327 213.673 239.927C215.374 242.921 217.084 245.915 218.397 249.109C219.511 251.944 222.445 252.74 225.29 251.626L225.668 251.407C227.916 250.124 228.722 247.19 227.807 244.733C226.484 241.52 224.565 238.168 222.645 234.796C219.234 228.807 215.454 223.048 211.894 217.656C210.252 215.627 206.94 215.039 204.911 216.7L204.901 216.7Z"
            fill="black"
        />
        <path
            d="M171.449 241.537C174.066 240.045 174.871 237.111 173.38 234.505L157.189 206.087C155.697 203.471 152.763 202.665 150.157 204.157C147.551 205.648 146.735 208.583 148.227 211.189L164.417 239.607C165.89 242.233 168.824 243.029 171.449 241.537Z"
            fill="black"
        />
        <path
            d="M203.832 298.364C206.448 296.872 207.254 293.938 205.763 291.332L189.572 262.914C188.08 260.298 185.146 259.492 182.54 260.984C179.934 262.475 179.118 265.41 180.61 268.016L196.8 296.434C198.273 299.06 201.207 299.856 203.832 298.364Z"
            fill="black"
        />

        {/* <!-- Banner background --> */}
        <path
            d="M265.72 210.174H58.1795C56.3957 210.174 54.9497 211.498 54.9497 213.13V301.218C54.9497 302.851 56.3957 304.174 58.1795 304.174H265.72C267.504 304.174 268.95 302.851 268.95 301.218V213.13C268.95 211.498 267.504 210.174 265.72 210.174Z"
            fill="black"
        />
        <path
            d="M259.901 216.174H63.9984C62.3146 216.174 60.9497 217.329 60.9497 218.753V295.596C60.9497 297.02 62.3146 298.174 63.9984 298.174H259.901C261.585 298.174 262.95 297.02 262.95 295.596V218.753C262.95 217.329 261.585 216.174 259.901 216.174Z"
            fill="#F9F4F0"
        />

        {/* <!-- BETA text --> */}
        <path
            d="M93.5 275.154V235.823H108.813C113.288 235.823 116.783 236.67 119.3 238.362C121.816 240.055 123.074 242.666 123.074 246.196C123.074 248.357 122.589 250.14 121.618 251.545C120.665 252.949 119.479 253.904 118.059 254.408V254.516C119.803 255.02 121.259 256.056 122.427 257.622C123.595 259.189 124.179 261.26 124.179 263.835C124.179 267.419 122.84 270.201 120.162 272.182C117.484 274.163 113.962 275.154 109.594 275.154H93.5ZM102.828 268.698H109.217C111.122 268.698 112.524 268.211 113.423 267.239C114.321 266.248 114.77 264.907 114.77 263.214C114.77 261.557 114.321 260.243 113.423 259.27C112.524 258.28 111.122 257.784 109.217 257.784H102.828V268.698ZM102.828 251.815H108.462C110.349 251.815 111.706 251.4 112.533 250.572C113.378 249.744 113.8 248.573 113.8 247.06C113.8 245.548 113.378 244.386 112.533 243.576C111.706 242.747 110.349 242.333 108.462 242.333H102.828V251.815Z"
            fill="black"
        />
        <path
            d="M130.326 275.154V235.823H157.365V242.9H139.653V251.491H154.939V258.406H139.653V268.13H157.662V275.154H130.326Z"
            fill="black"
        />
        <path d="M160.466 242.9V235.823H192.493V242.9H181.197V275.154H171.761V242.9H160.466Z" fill="black" />
        <path
            d="M189.958 275.154L204.759 235.661H214.922L230.046 275.154H219.91L210.178 248.114C209.962 247.502 209.791 246.916 209.665 246.358C209.539 245.8 209.432 245.251 209.342 244.71H209.126C209.036 245.251 208.928 245.809 208.803 246.385C208.677 246.943 208.506 247.52 208.29 248.114L198.639 275.154H189.958ZM199.044 267.077L201.038 260.27H218.076L220.098 267.077H199.044Z"
            fill="black"
        />
    </svg>
)

/**
 * full-page offline screen shown when user loses internet connection
 * displays peanut logo and helpful message about pwa cached content
 * when connection is restored, page automatically reloads
 */
export default function OfflineScreen() {
    // check if connection is restored before reloading
    const handleRetryConnection = () => {
        if (navigator.onLine) {
            // connection restored, reload the page
            window.location.reload()
        } else {
            // still offline, automatic polling will detect when back online
            console.log('Still offline, waiting for connection...')
        }
    }

    return (
        <div className="flex h-[100dvh] w-full flex-col items-center justify-center gap-6 bg-background p-6">
            <div className="h-32 w-32 opacity-50 grayscale">
                <PeanutIcon className="h-full w-full" />
            </div>
            <div className="flex flex-col items-center gap-2 text-center">
                <h1 className="text-2xl font-bold text-gray-800">You&apos;re Offline</h1>
                <p className="max-w-md text-sm text-gray-600">
                    No internet connection detected. Please check your network settings and try again.
                </p>
            </div>
            <Button
                shadowSize="4"
                icon="retry"
                size="medium"
                className="w-fit rounded-full"
                onClick={handleRetryConnection}
            >
                Check Connection
            </Button>
        </div>
    )
}
